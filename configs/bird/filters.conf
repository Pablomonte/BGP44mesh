# BGP Route Filters
# Sprint 1: Simplified filters for testing

# Export filter: Accept all for Sprint 1 (mesh iBGP)
filter export_bgp {
    accept;
}

# Import filter: Accept all for Sprint 1 (mesh iBGP)
filter import_bgp {
    accept;
}

# ISP Export filter: Only announce customer prefixes
# Rejects internal TINC mesh network (10.0.0.0/24)
filter export_to_isp {
    # Accept customer prefixes
    if net ~ [10.100.0.0/24, 10.200.0.0/24] then {
        print "Announcing customer prefix ", net, " to ISP";
        accept;
    }

    # Reject TINC mesh internal network
    if net ~ [10.0.0.0/24] then {
        print "Blocking internal mesh route ", net, " from ISP";
        reject;
    }

    # Reject everything else
    print "Rejecting unknown prefix ", net, " to ISP";
    reject;
}

# ISP Import filter: Accept all ISP routes with high local-pref
# This makes ISP routes preferred over any internal routes
filter import_from_isp {
    # Accept all from ISP with high preference
    bgp_local_pref = 200;
    print "Accepting ISP route ", net, " with local-pref 200";
    accept;
}
