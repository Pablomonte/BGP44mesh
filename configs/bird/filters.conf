# BGP Route Filters
# Sprint 1: Simplified filters for testing

# Export filter: Accept all for Sprint 1 (mesh iBGP)
filter export_bgp {
    accept;
}

# Import filter: Accept all for Sprint 1 (mesh iBGP)
filter import_bgp {
    accept;
}

# ISP Export filter: Only announce customer prefixes
# Rejects internal TINC mesh network (44.30.127.0/24)
filter export_to_isp {
    # CRITICAL: Export TINC mesh subnet so ISP can route to it
    if net ~ [44.30.127.0/24] then {
        print "Announcing TINC mesh ", net, " to ISP";
        accept;
    }
    # Reject everything else
    print "Rejecting unknown prefix ", net, " to ISP";
    reject;
}
# ISP Import filter: Accept all ISP routes with high local-pref
# This makes ISP routes preferred over any internal routes
filter import_from_isp {
    # Accept all from ISP with high preference
    bgp_local_pref = 200;
    print "Accepting ISP route ", net, " with local-pref 200";
    accept;
}
